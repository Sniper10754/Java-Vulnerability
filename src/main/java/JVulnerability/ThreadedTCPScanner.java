package JVulnerability;

import java.util.ArrayList;

public class ThreadedTCPScanner extends Thread {
    private final TCPScanner scanner;
    private final int start;
    private final int finish;
    private final int timeout;
    private final boolean printout;

    public ThreadedTCPScanner(String target, int start, int finish, int timeout, boolean printout) {
        scanner = new TCPScanner(target);
        this.finish = finish;
        this.start = start;
        this.timeout = timeout;
        this.printout = printout;
    }

    public int getCurrentPortScan() {
        if (!this.isAlive()) {
            return scanner.currentScanningPort;
        } else return 0;
    }

    public TCPScanner getScanner() {
        return scanner;
    }

    public ArrayList<Integer> getOpenPorts() {
        return scanner.getOpenPorts();
    }

    @Override
    public void run() {
        scanner.startScan(start, finish, timeout, printout);
    }

    public int getTimeout() {
        return timeout;
    }

    public int getStart() {
        return start;
    }

    public int getFinish() {
        return finish;
    }
}
